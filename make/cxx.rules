ifdef	TARGET

winapi:	api.h

api.h:	$(TARGET)DllApi.h
	@echo '// This is a generic DLL api definition. '			> $@
	@echo '// It allows touse a MYAPI statement for class definitions'	>> $@
	@echo '// instead of package-specific names. Thus, a class can easily'	>> $@
	@echo '// be moved from one dll to another one without change.'		>> $@
	@echo '// '								>> $@
	@echo '// However, this file MUST be included as the LAST include file'	>> $@
	@echo '// within a header file, just before the class definitions, via'	>> $@
	@echo '// #include "api.h"'						>> $@
	@echo '// If there is ANY #include statement after including this file'	>> $@
	@echo '// then things WILL go bad.'					>> $@
	@echo 									>> $@
	@echo 									>> $@
	@echo '#include "$(TARGET)DllApi.h"' 			>> $@
	@echo 							>> $@
	@echo '#undef	MYAPI'					>> $@ 
	@echo "#define	MYAPI $(EXPORTS)_API"			>> $@
	@echo 							>> $@


ifdef	GCC_HIDDEN_SUPPORT

$(TARGET)DllApi.h: $(MAKEFILE)
	@echo "#ifndef	__$(EXPORTS)DllApi_H__"					> $@
	@echo '#define	__$(EXPORTS)DllApi_H__ "2.0 - Generated by make system" ' >> $@
	@echo "/* See http://gcc.gnu.org/wiki/Visibility for explanation */"	>> $@
	@echo									>> $@
	@echo "#ifdef	__WINDOWS"						>> $@
	@echo "  #define $(EXPORTS)_HELPER_DLL_IMPORT __declspec(dllimport)"	>> $@
	@echo "  #define $(EXPORTS)_HELPER_DLL_EXPORT __declspec(dllexport)"	>> $@
	@echo "  #define $(EXPORTS)_HELPER_DLL_LOCAL			    "	>> $@
	@echo "#else"								>> $@
	@echo "  #if __GNUC__ >= 4"						>> $@
	@echo "    #define $(EXPORTS)_HELPER_DLL_IMPORT "'__attribute__ ((visibility ("default")))'	>> $@
	@echo "    #define $(EXPORTS)_HELPER_DLL_EXPORT "'__attribute__ ((visibility ("default")))'	>> $@
	@echo "    #define $(EXPORTS)_HELPER_DLL_LOCAL  "'__attribute__ ((visibility ("hidden")))'	>> $@
	@echo "  #else"							>> $@
	@echo "    #define $(EXPORTS)_HELPER_DLL_IMPORT"		>> $@
	@echo "    #define $(EXPORTS)_HELPER_DLL_EXPORT"		>> $@
	@echo "    #define $(EXPORTS)_HELPER_DLL_LOCAL"			>> $@
	@echo "  #endif"						>> $@
	@echo "#endif"							>> $@
	@echo								>> $@
	@echo								>> $@
	@echo "#ifndef	$(EXPORTS)_STATIC"				>> $@
	@echo 								>> $@
	@echo "# ifdef	$(EXPORTS)_EXPORTS"				>> $@
	@echo "#  define $(EXPORTS)_API $(EXPORTS)_HELPER_DLL_EXPORT"	>> $@
	@echo "# else"							>> $@
	@echo "#  define $(EXPORTS)_API $(EXPORTS)_HELPER_DLL_IMPORT"	>> $@
	@echo "# endif"							>> $@
	@echo "# define $(EXPORTS)_LOCAL $(EXPORTS)_HELPER_DLL_LOCAL"	>> $@
	@echo 								>> $@
	@echo "#else"							>> $@
	@echo "# define $(EXPORTS)_API"					>> $@
	@echo "# define $(EXPORTS)_LOCAL"				>> $@
	@echo "#endif"							>> $@
	@echo 								>> $@
	@echo "#endif /* __$(EXPORTS)DllApi_H__ */"			>> $@


else

$(TARGET)DllApi.h: $(MAKEFILE)
	@echo "#ifndef	__$(EXPORTS)DllApi_H__"					> $@
	@echo '#define	__$(EXPORTS)DllApi_H__ "Generated by make system" '	>> $@
	@echo							>> $@
	@echo "#ifdef	__WINDOWS"				>> $@
	@echo "# ifdef	$(EXPORTS)_EXPORTS"			>> $@
	@echo "#  define $(EXPORTS)_API __declspec(dllexport)"	>> $@
	@echo "# else"						>> $@
	@echo "#  define $(EXPORTS)_API __declspec(dllimport)"	>> $@
	@echo "# endif"						>> $@
	@echo "#else"						>> $@
	@echo "# define $(EXPORTS)_API"				>> $@
	@echo "#endif"						>> $@
	@echo 							>> $@
	@echo "#endif /* __$(EXPORTS)DllApi_H__ */"		>> $@

endif



ifndef	CLASS
class:
	@echo
	@echo 'Please specify CLASS=<classname> .'
	@echo

else

class:	$(CLASS).hpp $(CLASS).cpp

$(CLASS).hpp:
	@echo '///////////////////////////////////////////////' >  $@
	@echo '//'					       >> $@
	@echo '// $$''Id:$$'				       >> $@
	@echo '//'					       >> $@
	@echo '// $$''Log:$$'				       >> $@
	@echo '//'					       >> $@
	@echo '///////////////////////////////////////////////' >> $@
	@echo '#ifndef __$(TARGET)_$(CLASS)_HPP'		>> $@
	@date +'#define __$(TARGET)_$(CLASS)_HPP "created %H:%M:%S on %d %h %y by ${USER}"'>> $@
	@echo ''						>> $@
	@echo '//#include "$(TARGET)DllApi.h"'			>> $@
	@echo ''						>> $@
	@echo '// namespace $(TARGET)'				>> $@
	@echo '// {'						>> $@
	@echo ''						>> $@
	@echo '/** @ingroup $(TARGET)'				>> $@
	@echo '  @todo Documentation for class $(CLASS).'	>> $@
	@echo ' */'						>> $@
	@echo 'class  $(TARGET)_API $(CLASS)'			>> $@
	@echo '{'						>> $@
	@echo 'public:'						>> $@
	@echo '	/// Constructor for $(CLASS)'			>> $@
	@echo '	$(CLASS)();'					>> $@
	@echo ''						>> $@
	@echo '	/// Destructor for $(CLASS)'			>> $@
	@echo '	~$(CLASS)();'					>> $@
	@echo ''						>> $@
	@echo '};'						>> $@
	@echo ''						>> $@
	@echo '// } // namespace $(TARGET)'			>> $@
	@echo ''						>> $@
	@echo '#endif // __$(TARGET)_$(CLASS)_HPP'		>> $@
	@echo Created $@ ...


$(CLASS).cpp:
	@echo '#include "$(CLASS).hpp"'				> $@
	@echo ''						>> $@
	@echo '// namespace $(TARGET)'				>> $@
	@echo '// {'						>> $@
	@echo ''						>> $@
	@echo '$(CLASS)::$(CLASS)()'				>> $@
	@echo '{'						>> $@
	@echo '}'						>> $@
	@echo ''						>> $@
	@echo '$(CLASS)::~$(CLASS)()'				>> $@
	@echo '{'						>> $@
	@echo '}'						>> $@
	@echo ''						>> $@
	@echo '// } // namespace $(TARGET)'			>> $@
	@echo ''						>> $@
	@echo Created $@ ...

endif

endif

